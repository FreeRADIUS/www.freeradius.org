<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<HTML>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <meta name="GENERATOR" content="Perl">
   <title>rfc4590.html</title>
</head>
<body>
<PRE>







Network Working Group                                         B. Sterman
Request for Comments: 4590                               Kayote Networks
Category: Standards Track                                  D. Sadolevsky
                                                          SecureOL, Inc.
                                                             D. Schwartz
                                                         Kayote Networks
                                                             D. Williams
                                                           Cisco Systems
                                                                 W. Beck
                                                     Deutsche Telekom AG
                                                               July 2006


               RADIUS Extension for Digest Authentication

Status of This Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the "Internet
   Official Protocol Standards" (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.

Copyright Notice

   Copyright (C) The Internet Society (2006).

Abstract

   This document defines an extension to the Remote Authentication
   Dial-In User Service (RADIUS) protocol to enable support of Digest
   Authentication, for use with HTTP-style protocols like the Session
   Initiation Protocol (SIP) and HTTP.

Table of Contents

1. Introduction ....................................................2
   1.1. Terminology ................................................2
   1.2. Motivation .................................................3
   1.3. Overview ...................................................4
2. Detailed Description ............................................6
   2.1. RADIUS Client Behavior .....................................6
        2.1.1. Credential Selection ................................6
        2.1.2. Constructing an <A HREF="rfc2865.html#Access-Request">Access-Request</A> ......................6
        2.1.3. Constructing an Authentication-Info Header ..........7
        2.1.4. Failed Authentication ...............................8
        2.1.5. Obtaining Nonces ....................................9
   2.2. RADIUS Server Behavior .....................................9



Sterman, et al.             Standards Track                     [Page 1]

RFC 4590              RADIUS Digest Authentication             July 2006


        2.2.1. General Attribute Checks ............................9
        2.2.2. Authentication .....................................10
        2.2.3. Constructing the Reply .............................11
3. New RADIUS Attributes ..........................................12
   3.1. <A HREF="#Digest-Response">Digest-Response</A> attribute .................................12
   3.2. <A HREF="#Digest-Realm">Digest-Realm</A> Attribute ....................................13
   3.3. <A HREF="#Digest-Nonce">Digest-Nonce</A> Attribute ....................................13
   3.4. <A HREF="#Digest-Response-Auth">Digest-Response-Auth</A> Attribute ............................14
   3.5. <A HREF="#Digest-Nextnonce">Digest-Nextnonce</A> Attribute ................................14
   3.6. <A HREF="#Digest-Method">Digest-Method</A> Attribute ...................................14
   3.7. <A HREF="#Digest-URI">Digest-URI</A> Attribute ......................................15
   3.8. <A HREF="#Digest-Qop">Digest-Qop</A> Attribute ......................................15
   3.9. <A HREF="#Digest-Algorithm">Digest-Algorithm</A> Attribute ................................16
   3.10. <A HREF="#Digest-Entity-Body-Hash">Digest-Entity-Body-Hash</A> Attribute ........................16
   3.11. <A HREF="#Digest-CNonce">Digest-CNonce</A> Attribute ..................................17
   3.12. <A HREF="#Digest-Nonce-Count">Digest-Nonce-Count</A> Attribute .............................17
   3.13. <A HREF="#Digest-Username">Digest-Username</A> Attribute ................................17
   3.14. <A HREF="#Digest-Opaque">Digest-Opaque</A> Attribute ..................................18
   3.15. <A HREF="#Digest-Auth-Param">Digest-Auth-Param</A> Attribute ..............................18
   3.16. <A HREF="#Digest-AKA-Auts">Digest-AKA-Auts</A> Attribute ................................19
   3.17. <A HREF="#Digest-Domain">Digest-Domain</A> Attribute ..................................19
   3.18. <A HREF="#Digest-Stale">Digest-Stale</A> Attribute ...................................20
   3.19. Digest-HA1 Attribute .....................................20
   3.20. <A HREF="#SIP-AOR">SIP-AOR</A> Attribute ........................................21
4. Diameter Compatibility .........................................21
5. Table of Attributes ............................................22
6. Examples .......................................................23
7. IANA Considerations ............................................27
8. Security Considerations ........................................27
   8.1. Denial of Service .........................................28
   8.2. Confidentiality and Data Integrity ........................28
9. Acknowledgements ...............................................29
10. References ....................................................29
   10.1. Normative References .....................................29
   10.2. Informative References ...................................30

<H2>1.  Introduction</H2>

<H2>1.1.  Terminology</H2>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [RFC2119].

   The use of normative requirement key words in this document shall
   apply only to RADIUS client and RADIUS server implementations that
   include the features described in this document.  This document
   creates no normative requirements for existing implementations.



Sterman, et al.             Standards Track                     [Page 2]

RFC 4590              RADIUS Digest Authentication             July 2006


   HTTP-style protocol
         The term 'HTTP-style' denotes any protocol that uses HTTP-like
         headers and uses HTTP Digest Authentication as described in
         [RFC2617].  Examples are HTTP and the Session Initiation
         Protocol (SIP).

   NAS
         Network Access Server, the RADIUS client.

   nonce
         An unpredictable value used to prevent replay attacks.  The
         nonce generator may use cryptographic mechanisms to produce
         nonces it can recognize without maintaining state.

   protection space
         HTTP-style protocols differ in their definition of the
         protection space.  For HTTP, it is defined as the combination
         of realm and canonical root URL of the requested resource for
         which the use is authorized by the RADIUS server.  In the case
         of SIP, the realm string alone defines the protection space.

   SIP UA
         SIP User Agent, an Internet endpoint that uses the Session
         Initiation Protocol.

   SIP UAS
         SIP User Agent Server, a logical entity that generates a
         response to a SIP (Session Initiation Protocol) request.

<H2>1.2.  Motivation</H2>

   The HTTP Digest Authentication mechanism, defined in [RFC2617], was
   subsequently adapted for use with SIP [RFC3261].  Due to the
   limitations and weaknesses of Digest Authentication (see [RFC2617],
   section 4), additional authentication and encryption mechanisms are
   defined in SIP [RFC3261], including Transport Layer Security (TLS)
   [RFC4346] and Secure MIME (S/MIME) [RFC3851].  However, Digest
   Authentication support is mandatory in SIP implementations, and
   Digest Authentication is the preferred way for a SIP UA to
   authenticate itself to a proxy server.  Digest Authentication is used
   in other protocols as well.

   To simplify the provisioning of users, there is a need to support
   this authentication mechanism within Authentication, Authorization,
   and Accounting (AAA) protocols such as RADIUS [RFC2865] and Diameter
   [RFC3588].





Sterman, et al.             Standards Track                     [Page 3]

RFC 4590              RADIUS Digest Authentication             July 2006


   This document defines an extension to the RADIUS protocol to enable
   support of Digest Authentication for use with SIP, HTTP, and other
   HTTP-style protocols using this authentication method.  Support for
   Digest mechanisms such as Authentication and Key Agreement (AKA)
   [RFC3310] is also supported.  A companion document [SIP-APP] defines
   support for Digest Authentication within Diameter.

<H2>1.3.  Overview</H2>

   HTTP Digest is a challenge-response protocol used to authenticate a
   client's request to access some resource on a server.  Figure 1 shows
   a single HTTP Digest transaction.

                                 HTTP/SIP..
                  +------------+  (1)     +------------+
                  |            |---------&gt;|            |
                  | HTTP-style |  (2)     | HTTP-style |
                  | client     |&lt;---------| server     |
                  |            |  (3)     |            |
                  |            |---------&gt;|            |
                  |            |  (4)     |            |
                  |            |&lt;---------|            |
                  +------------+          +------------+

                 Figure 1: Digest operation without RADIUS

   If the client sends a request without any credentials (1), the server
   will reply with an error response (2) containing a nonce.  The client
   creates a cryptographic digest from parts of the request, from the
   nonce it received from the server, and from a shared secret.  The
   client re-transmits the request (3) to the server, but now includes
   the digest within the packet.  The server does the same digest
   calculation as the client and compares the result with the digest it
   received in (3).  If the digest values are identical, the server
   grants access to the resource and sends a positive response to the
   client (4).  If the digest values differ, the server sends a negative
   response to the client (4).

   Instead of maintaining a local user database, the server could use
   RADIUS to access a centralized user database.  However, RADIUS
   [RFC2865] does not include support for HTTP Digest Authentication.
   The RADIUS client cannot use the <A HREF="rfc2865.html#User-Password">User-Password</A> attribute, since it
   does not receive a password from the HTTP-style client.  The
   <A HREF="rfc2865.html#CHAP-Challenge">CHAP-Challenge</A> and <A HREF="rfc2865.html#CHAP-Password">CHAP-Password</A> attributes described in [RFC1994]
   are also not suitable since the CHAP algorithm is not compatible with
   HTTP Digest.





Sterman, et al.             Standards Track                     [Page 4]

RFC 4590              RADIUS Digest Authentication             July 2006


   This document defines new attributes that enable the RADIUS server to
   perform the digest calculation defined in [RFC2617], providing
   support for Digest Authentication as a native authentication
   mechanism within RADIUS.

   The nonces required by the digest algorithm are generated by the
   RADIUS server.  Generating them in the RADIUS client would save a
   round-trip, but introduce security and operational issues.  Some
   digest algorithms -- e.g., AKA [RFC3310] -- would not work.

   Figure 2 depicts a scenario in which the HTTP-style server defers
   authentication to a RADIUS server.  Entities A and B communicate
   using HTTP or SIP, while entities B and C communicate using RADIUS.

                        HTTP/SIP           RADIUS

               +-----+    (1)    +-----+           +-----+
               |     |==========&gt;|     |    (2)    |     |
               |     |           |     |----------&gt;|     |
               |     |           |     |    (3)    |     |
               |     |    (4)    |     |&lt;----------|     |
               |     |&lt;==========|     |           |     |
               |     |    (5)    |     |           |     |
               |     |==========&gt;|     |           |     |
               |  A  |           |  B  |    (6)    |  C  |
               |     |           |     |----------&gt;|     |
               |     |           |     |    (7)    |     |
               |     |           |     |&lt;----------|     |
               |     |    (8)    |     |           |     |
               |     |&lt;==========|     |           |     |
               +-----+           +-----+           +-----+

               ====&gt; HTTP/SIP
               ----&gt; RADIUS

                    Figure 2: HTTP Digest over RADIUS

   The entities have the following roles:

   A: HTTP client / SIP UA

   B: {HTTP server / HTTP proxy server / SIP proxy server / SIP UAS}
      acting also as a RADIUS NAS

   C: RADIUS server






Sterman, et al.             Standards Track                     [Page 5]

RFC 4590              RADIUS Digest Authentication             July 2006


   The following messages are sent in this scenario:

   A sends B an HTTP/SIP request without an authorization header (step
   1).  B sends an <A HREF="rfc2865.html#Access-Request">Access-Request</A> packet with the newly defined
   <A HREF="#Digest-Method">Digest-Method</A> and <A HREF="#Digest-URI">Digest-URI</A> attributes but without a <A HREF="#Digest-Nonce">Digest-Nonce</A>
   attribute to the RADIUS server, C (step 2).  C chooses a nonce and
   responds with an <A HREF="rfc2865.html#<A HREF="rfc2865.html#Access-Challenge">Access-Challenge</A>"><A HREF="rfc2865.html#Access-Challenge">Access-Challenge</A></A> (step 3).  This <A HREF="rfc2865.html#<A HREF="rfc2865.html#Access-Challenge">Access-Challenge</A>"><A HREF="rfc2865.html#Access-Challenge">Access-Challenge</A></A>
   contains Digest attributes, from which B takes values to construct an
   HTTP/SIP "(Proxy) Authorization required" response.  B sends this
   response to A (step 4).  A resends its request with its credentials
   (step 5).  B sends an <A HREF="rfc2865.html#Access-Request">Access-Request</A> to C (step 6).  C checks the
   credentials and replies with <A HREF="rfc2865.html#Access-Accept">Access-Accept</A> or <A HREF="rfc2865.html#Access-Reject">Access-Reject</A> (step 7).
   Depending on C's result, B processes A's request or rejects it with a
   "(Proxy) Authorization required" response (step 8).

<H2>2.  Detailed Description</H2>

<H2>2.1.  RADIUS Client Behavior</H2>

   The attributes described in this document are sent in cleartext.
   Therefore, were a RADIUS client to accept secure connections (HTTPS
   or SIPS) from HTTP-style clients, this could result in information
   intentionally protected by HTTP-style clients being sent in the clear
   during RADIUS exchange.

<H2>2.1.1.  Credential Selection</H2>

   On reception of an HTTP-style request message, the RADIUS client
   checks whether it is authorized to authenticate the request.  Where
   an HTTP-style request traverses several proxies and each of the
   proxies requests to authenticate the HTTP-style client, the request
   at the HTTP-style server may contain multiple credential sets.

   The RADIUS client can use the 'realm' directive in HTTP to determine
   which credentials are applicable.  Where none of the realms are of
   interest, the RADIUS client MUST behave as though no relevant
   credentials were sent.  In all situations, the RADIUS client MUST
   send zero or exactly one credential to the RADIUS server.  The RADIUS
   client MUST choose the credential of the (Proxy-)Authorization header
   if the realm directive matches its locally configured realm.

<H2>2.1.2.  Constructing an Access-Request</H2>

   If a matching (Proxy-)Authorization header is present and contains
   HTTP Digest information, the RADIUS client checks the 'nonce'
   parameter.





Sterman, et al.             Standards Track                     [Page 6]

RFC 4590              RADIUS Digest Authentication             July 2006


   If the RADIUS client recognizes the nonce, it takes the header
   directives and puts them into a RADIUS <A HREF="rfc2865.html#Access-Request">Access-Request</A> packet.  It
   puts the 'response' directive into a <A HREF="#Digest-Response">Digest-Response</A> attribute and
   the realm, nonce, digest-uri, qop, algorithm, cnonce, nc, username,
   and opaque directives into the respective <A HREF="#Digest-Realm">Digest-Realm</A>, <A HREF="#Digest-Nonce">Digest-Nonce</A>,
   <A HREF="#Digest-URI">Digest-URI</A>, <A HREF="#Digest-Qop">Digest-Qop</A>, <A HREF="#Digest-Algorithm">Digest-Algorithm</A>, <A HREF="#Digest-CNonce">Digest-CNonce</A>,
   <A HREF="#Digest-Nonce-Count">Digest-Nonce-Count</A>, <A HREF="#Digest-Username">Digest-Username</A>, and <A HREF="#Digest-Opaque">Digest-Opaque</A> attributes.
   The RADIUS client puts the request method into the <A HREF="#Digest-Method">Digest-Method</A>
   attribute.

   Due to syntactic requirements, HTTP-style protocols have to escape
   with backslash all quote and backslash characters in contents of HTTP
   Digest directives.  When translating directives into RADIUS
   attributes, the RADIUS client only removes the surrounding quotes
   where present.  See Section 3 for an example.

   If the Quality of Protection (qop) directive's value is 'auth-int',
   the RADIUS client calculates H(entity-body) as described in
   [RFC2617], Section 3.2.1, and puts the result in a
   <A HREF="#Digest-Entity-Body-Hash">Digest-Entity-Body-Hash</A> attribute.

   The RADIUS client adds a <A HREF="rfc2869.html#Message-Authenticator">Message-Authenticator</A> attribute, defined in
   [RFC3579], and sends the <A HREF="rfc2865.html#Access-Request">Access-Request</A> packet to the RADIUS server.

   The RADIUS server processes the packet and responds with an
   <A HREF="rfc2865.html#Access-Accept">Access-Accept</A> or an <A HREF="rfc2865.html#Access-Reject">Access-Reject</A>.

<H2>2.1.3.  Constructing an Authentication-Info Header</H2>

   After having received an <A HREF="rfc2865.html#Access-Accept">Access-Accept</A> from the RADIUS server, the
   RADIUS client constructs an Authentication-Info header:

   o  If the <A HREF="rfc2865.html#Access-Accept">Access-Accept</A> packet contains a <A HREF="#Digest-Response-Auth">Digest-Response-Auth</A>
      attribute, the RADIUS client checks the <A HREF="#Digest-Qop">Digest-Qop</A> attribute:

      *  If the <A HREF="#Digest-Qop">Digest-Qop</A> attribute's value is 'auth' or not specified,
         the RADIUS client puts the <A HREF="#Digest-Response-Auth">Digest-Response-Auth</A> attribute's
         content into the Authentication-Info header's 'rspauth'
         directive of the HTTP-style response.

      *  If the <A HREF="#Digest-Qop">Digest-Qop</A> attribute's value is 'auth-int', the RADIUS
         client ignores the <A HREF="rfc2865.html#Access-Accept">Access-Accept</A> packet and behaves as if it
         had received an <A HREF="rfc2865.html#Access-Reject">Access-Reject</A> packet (<A HREF="#Digest-Response-Auth">Digest-Response-Auth</A>
         can't be correct as the RADIUS server does not know the
         contents of the HTTP-style response's body).






Sterman, et al.             Standards Track                     [Page 7]

RFC 4590              RADIUS Digest Authentication             July 2006


   o  If the <A HREF="rfc2865.html#Access-Accept">Access-Accept</A> packet contains a Digest-HA1 attribute, the
      RADIUS client checks the 'qop' and 'algorithm' directives in the
      Authorization header of the HTTP-style request it wants to
      authorize:

      *  If the 'qop' directive is missing or its value is 'auth', the
         RADIUS client ignores the Digest-HA1 attribute.  It does not
         include an Authentication-Info header in its HTTP-style
         response.

      *  If the 'qop' directive's value is 'auth-int' and at least one
         of the following conditions is true, the RADIUS client
         calculates the contents of the HTTP-style response's 'rspauth'
         directive:

         +  The algorithm directive's value is 'MD5-sess' or
            'AKAv1-MD5-sess'.

         +  IP Security (IPsec) is configured to protect traffic between
            the RADIUS client and RADIUS server with IPsec (see
            Section 8).

         It creates the HTTP-style response message and calculates the
         hash of this message's body.  It uses the result and the
         <A HREF="#Digest-URI">Digest-URI</A> attribute's value of the corresponding
         <A HREF="rfc2865.html#Access-Request">Access-Request</A> packet to perform the H(A2) calculation.  It
         takes the <A HREF="#Digest-Nonce">Digest-Nonce</A>, <A HREF="#Digest-Nonce">Digest-Nonce</A>-Count, <A HREF="#Digest-CNonce">Digest-CNonce</A>, and
         <A HREF="#Digest-Qop">Digest-Qop</A> values of the corresponding <A HREF="rfc2865.html#Access-Request">Access-Request</A> and the
         Digest-HA1 attribute's value to finish the computation of the
         'rspauth' value.

   o  If the <A HREF="rfc2865.html#Access-Accept">Access-Accept</A> packet contains neither a
      <A HREF="#Digest-Response-Auth">Digest-Response-Auth</A> nor a Digest-HA1 attribute, the RADIUS client
      will not create an Authentication-Info header for its HTTP-style
      response.

   When the RADIUS server provides a <A HREF="#Digest-Nextnonce">Digest-Nextnonce</A> attribute in the
   <A HREF="rfc2865.html#Access-Accept">Access-Accept</A> packet, the RADIUS client puts the contents of this
   attribute into a 'nextnonce' directive.  Now it can send an
   HTTP-style response.

<H2>2.1.4.  Failed Authentication</H2>

   If the RADIUS client did receive an HTTP-style request without a
   (Proxy-)Authorization header matching its locally configured realm
   value, it obtains a new nonce and sends an error response (401 or
   407) containing a (Proxy-)Authenticate header.




Sterman, et al.             Standards Track                     [Page 8]

RFC 4590              RADIUS Digest Authentication             July 2006


   If the RADIUS client receives an <A HREF="rfc2865.html#Access-Challenge">Access-Challenge</A> packet in response
   to an <A HREF="rfc2865.html#Access-Request">Access-Request</A> containing a <A HREF="#Digest-Nonce">Digest-Nonce</A> attribute, the RADIUS
   server did not accept the nonce.  If a <A HREF="#Digest-Stale">Digest-Stale</A> attribute is
   present in the <A HREF="rfc2865.html#Access-Challenge">Access-Challenge</A> and has a value of 'true' (without
   surrounding quotes), the RADIUS client sends an error response (401
   or 407) containing a WWW-/Proxy-Authenticate header with the
   directive 'stale' and the digest directives derived from the Digest-*
   attributes.

   If the RADIUS client receives an <A HREF="rfc2865.html#Access-Reject">Access-Reject</A> from the RADIUS
   server, it sends an error response to the HTTP-style request it has
   received.  If the RADIUS client does not receive a response, it
   retransmits or fails over to another RADIUS server as described in
   [RFC2865].

<H2>2.1.5.  Obtaining Nonces</H2>

   The RADIUS client has two ways to obtain nonces: it has received one
   in a <A HREF="#Digest-Nextnonce">Digest-Nextnonce</A> attribute of a previously received
   <A HREF="rfc2865.html#Access-Accept">Access-Accept</A> packet or it asks the RADIUS server for one.  To do the
   latter, it sends an <A HREF="rfc2865.html#Access-Request">Access-Request</A> containing a <A HREF="#Digest-Method">Digest-Method</A> and a
   <A HREF="#Digest-URI">Digest-URI</A> attribute but without a <A HREF="#Digest-Nonce">Digest-Nonce</A> attribute.  It adds a
   <A HREF="rfc2869.html#Message-Authenticator">Message-Authenticator</A> (see [RFC3579]) attribute to the <A HREF="rfc2865.html#Access-Request">Access-Request</A>
   packet.  The RADIUS server chooses a nonce and responds with an
   <A HREF="rfc2865.html#Access-Challenge">Access-Challenge</A> containing a <A HREF="#Digest-Nonce">Digest-Nonce</A> attribute.

   The RADIUS client constructs a (Proxy-)Authenticate header using the
   received <A HREF="#Digest-Nonce">Digest-Nonce</A> and <A HREF="#Digest-Realm">Digest-Realm</A> attributes to fill the nonce
   and realm directives.  The RADIUS server can send <A HREF="#Digest-Qop">Digest-Qop</A>,
   <A HREF="#Digest-Algorithm">Digest-Algorithm</A>, <A HREF="#Digest-Domain">Digest-Domain</A>, and <A HREF="#Digest-Opaque">Digest-Opaque</A> attributes in the
   <A HREF="rfc2865.html#Access-Challenge">Access-Challenge</A> carrying the nonce.  If these attributes are
   present, the client MUST use them.

<H2>2.2.  RADIUS Server Behavior</H2>

   If the RADIUS server receives an <A HREF="rfc2865.html#Access-Request">Access-Request</A> packet with a
   <A HREF="#Digest-Method">Digest-Method</A> and a <A HREF="#Digest-URI">Digest-URI</A> attribute but without a <A HREF="#Digest-Nonce">Digest-Nonce</A>
   attribute, it chooses a nonce.  It puts the nonce into a <A HREF="#Digest-Nonce">Digest-Nonce</A>
   attribute and sends it in an <A HREF="rfc2865.html#Access-Challenge">Access-Challenge</A> packet to the RADIUS
   client.  The RADIUS server MUST add <A HREF="#Digest-Realm">Digest-Realm</A>,
   <A HREF="rfc2869.html#Message-Authenticator">Message-Authenticator</A> (see [RFC3579]), SHOULD add <A HREF="#Digest-Algorithm">Digest-Algorithm</A>
   and one or more <A HREF="#Digest-Qop">Digest-Qop</A>, and MAY add <A HREF="#Digest-Domain">Digest-Domain</A> or
   <A HREF="#Digest-Opaque">Digest-Opaque</A> attributes to the <A HREF="rfc2865.html#Access-Challenge">Access-Challenge</A> packet.

<H2>2.2.1.  General Attribute Checks</H2>

   If the RADIUS server receives an <A HREF="rfc2865.html#Access-Request">Access-Request</A> packet containing a
   <A HREF="#Digest-Response">Digest-Response</A> attribute, it looks for the following attributes:



Sterman, et al.             Standards Track                     [Page 9]

RFC 4590              RADIUS Digest Authentication             July 2006


   <A HREF="#Digest-Realm">Digest-Realm</A>, <A HREF="#Digest-Nonce">Digest-Nonce</A>, <A HREF="#Digest-Method">Digest-Method</A>, <A HREF="#Digest-URI">Digest-URI</A>, <A HREF="#Digest-Qop">Digest-Qop</A>,
   <A HREF="#Digest-Algorithm">Digest-Algorithm</A>, and <A HREF="#Digest-Username">Digest-Username</A>.  Depending on the content of
   <A HREF="#Digest-Algorithm">Digest-Algorithm</A> and <A HREF="#Digest-Qop">Digest-Qop</A>, it looks for
   <A HREF="#Digest-Entity-Body-Hash">Digest-Entity-Body-Hash</A>, <A HREF="#Digest-CNonce">Digest-CNonce</A>, and <A HREF="#Digest-AKA-Auts">Digest-AKA-Auts</A>, too.
   See [RFC2617] and [RFC3310] for details.  If the <A HREF="#Digest-Algorithm">Digest-Algorithm</A>
   attribute is missing, 'MD5' is assumed.  If the RADIUS server has
   issued a <A HREF="#Digest-Opaque">Digest-Opaque</A> attribute along with the nonce, the
   <A HREF="rfc2865.html#Access-Request">Access-Request</A> MUST have a matching <A HREF="#Digest-Opaque">Digest-Opaque</A> attribute.

   If mandatory attributes are missing, it MUST respond with an
   <A HREF="rfc2865.html#Access-Reject">Access-Reject</A> packet.

   The RADIUS server removes '\' characters that escape quote and '\'
   characters from the text values it has received in the Digest-*
   attributes.

   If the mandatory attributes are present, the RADIUS server MUST check
   if the RADIUS client is authorized to serve users of the realm
   mentioned in the <A HREF="#Digest-Realm">Digest-Realm</A> attribute.  If the RADIUS client is not
   authorized, the RADIUS server MUST send an <A HREF="rfc2865.html#Access-Reject">Access-Reject</A>.  The RADIUS
   server SHOULD log the event so as to notify the operator, and MAY
   take additional action such as sending an <A HREF="rfc2865.html#Access-Reject">Access-Reject</A> in response
   to all future requests from this client, until this behavior is reset
   by management action.

   The RADIUS server determines the age of the nonce in <A HREF="#Digest-Nonce">Digest-Nonce</A> by
   using an embedded time-stamp or by looking it up in a local table.
   The RADIUS server MUST check the integrity of the nonce if it embeds
   the time-stamp in the nonce.  Section 2.2.2 describes how the server
   handles old nonces.

<H2>2.2.2.  Authentication</H2>

   If the <A HREF="rfc2865.html#Access-Request">Access-Request</A> message has passed the checks described above,
   the RADIUS server calculates the digest response as described in
   [RFC2617].  To look up the password, the RADIUS server uses the
   RADIUS <A HREF="rfc2865.html#User-Name">User-Name</A> attribute.  The RADIUS server MUST check if the user
   identified by the <A HREF="rfc2865.html#User-Name">User-Name</A> attribute

   o  is authorized to access the protection space and

   o  is authorized to use the URI included in the <A HREF="#SIP-AOR">SIP-AOR</A> attribute, if
      this attribute is present.

   If any of those checks fails, the RADIUS server MUST send an
   <A HREF="rfc2865.html#Access-Reject">Access-Reject</A>.





Sterman, et al.             Standards Track                    [Page 10]

RFC 4590              RADIUS Digest Authentication             July 2006


   Correlation between <A HREF="rfc2865.html#User-Name">User-Name</A> and <A HREF="#SIP-AOR">SIP-AOR</A> AVP values is required just
   to avoid that any user can register or misuse a <A HREF="#SIP-AOR">SIP-AOR</A> allocated to
   a different user.

   All values required for the digest calculation are taken from the
   Digest attributes described in this document.  If the calculated
   digest response equals the value received in the <A HREF="#Digest-Response">Digest-Response</A>
   attribute, the authentication was successful.

   If the response values match, but the RADIUS server considers the
   nonce in the <A HREF="#Digest-Nonce">Digest-Nonce</A> attribute as too old, it sends an
   <A HREF="rfc2865.html#Access-Challenge">Access-Challenge</A> packet containing a new nonce and a <A HREF="#Digest-Stale">Digest-Stale</A>
   attribute with a value of 'true' (without surrounding quotes).

   If the response values don't match, the RADIUS server responds with
   an <A HREF="rfc2865.html#Access-Reject">Access-Reject</A>.

<H2>2.2.3.  Constructing the Reply</H2>

   If the authentication was successful, the RADIUS server adds an
   attribute to the <A HREF="rfc2865.html#Access-Accept">Access-Accept</A> packet that can be used by the RADIUS
   client to construct an Authentication-Info header:

   o  If the <A HREF="#Digest-Qop">Digest-Qop</A> attribute's value is 'auth' or unspecified, the
      RADIUS server SHOULD put a <A HREF="#Digest-Response-Auth">Digest-Response-Auth</A> attribute into the
      <A HREF="rfc2865.html#Access-Accept">Access-Accept</A> packet.

   o  If the <A HREF="#Digest-Qop">Digest-Qop</A> attribute's value is 'auth-int' and at least one
      of the following conditions is true, the RADIUS server SHOULD put
      a Digest-HA1 attribute into the <A HREF="rfc2865.html#Access-Accept">Access-Accept</A> packet:

      *  The <A HREF="#Digest-Algorithm">Digest-Algorithm</A> attribute's value is 'MD5-sess' or
         'AKAv1-MD5-sess'.

      *  IPsec is configured to protect traffic between the RADIUS
         client and RADIUS server with IPsec (see Section 8).

   In all other cases, <A HREF="#Digest-Response-Auth">Digest-Response-Auth</A> or Digest-HA1 MUST NOT be
   sent.

   RADIUS servers MAY construct a <A HREF="#Digest-Nextnonce">Digest-Nextnonce</A> attribute and add it
   to the <A HREF="rfc2865.html#Access-Accept">Access-Accept</A> packet.  This is useful to limit the lifetime of
   a nonce and to save a round-trip in future requests (see nextnonce
   discussion in [RFC2617], section 3.2.3).  The RADIUS server adds a
   <A HREF="rfc2869.html#Message-Authenticator">Message-Authenticator</A> attribute (see [RFC3579]) and sends the
   <A HREF="rfc2865.html#Access-Accept">Access-Accept</A> packet to the RADIUS client.





Sterman, et al.             Standards Track                    [Page 11]

RFC 4590              RADIUS Digest Authentication             July 2006


   If the RADIUS server does not accept the nonce received in an
   <A HREF="rfc2865.html#Access-Request">Access-Request</A> packet but authentication was successful, the RADIUS
   server MUST send an <A HREF="rfc2865.html#Access-Challenge">Access-Challenge</A> packet containing a <A HREF="#Digest-Stale">Digest-Stale</A>
   attribute set to 'true' (without surrounding quotes).  The RADIUS
   server MUST add <A HREF="rfc2869.html#Message-Authenticator">Message-Authenticator</A> (see [RFC3579]), <A HREF="#Digest-Nonce">Digest-Nonce</A>,
   <A HREF="#Digest-Realm">Digest-Realm</A>, SHOULD add <A HREF="#Digest-Algorithm">Digest-Algorithm</A> and one or more <A HREF="#Digest-Qop">Digest-Qop</A>
   and MAY add <A HREF="#Digest-Domain">Digest-Domain</A>, <A HREF="#Digest-Opaque">Digest-Opaque</A> attributes to the
   <A HREF="rfc2865.html#Access-Challenge">Access-Challenge</A> packet.

<H2>3.  New RADIUS Attributes</H2>

   If not stated otherwise, the attributes have the following format:

   0                   1                   2
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |  Length       | Text ...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Quote and backslash characters in Digest-* attributes representing
   HTTP-style directives with a quoted-string syntax are escaped.  The
   surrounding quotes are removed.  They are syntactical delimiters that
   are redundant in RADIUS.  For example, the directive

   realm="the \"example\" value"

   is represented as follows:

   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | <A HREF="#Digest-Realm">Digest-Realm</A>  |       23      | the \"example\" value |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

<A NAME="Digest-Response"><H2>3.1.  Digest-Response attribute</H2></a>

<B>   Description</B>
         If this attribute is present in an <A HREF="rfc2865.html#Access-Request">Access-Request</A> message, a
         RADIUS server implementing this specification MUST treat the
         <A HREF="rfc2865.html#Access-Request">Access-Request</A> as a request for Digest Authentication.  When a
         RADIUS client receives a (Proxy-)Authorization header, it puts
         the request-digest value into a <B>Digest-Response</B> attribute.
         This attribute (which enables the user to prove possession of
         the password) MUST only be used in Access-Requests.
<B>   Type</B>
         103 for <B>Digest-Response</B>.
<B>   Length</B>
         &gt;= 3





Sterman, et al.             Standards Track                    [Page 12]

RFC 4590              RADIUS Digest Authentication             July 2006


   Text
         When using HTTP Digest, the text field is 32 octets long and
         contains a hexadecimal representation of a 16-octet digest
         value as it was calculated by the authenticated client.  Other
         digest algorithms MAY define different digest lengths.  The
         text field MUST be copied from request-digest of
         digest-response ([RFC2617]) without surrounding quotes.

<A NAME="Digest-Realm"><H2>3.2.  Digest-Realm Attribute</H2></a>

<B>   Description</B>
         This attribute describes a protection space component of the
         RADIUS server.  HTTP-style protocols differ in their definition
         of the protection space.  See [RFC2617], Section 1.2, for
         details.  It MUST only be used in <A HREF="rfc2865.html#Access-Request">Access-Request</A> and
         <A HREF="rfc2865.html#Access-Challenge">Access-Challenge</A> packets.
<B>   Type</B>
         104 for <B>Digest-Realm</B>
<B>   Length</B>
         &gt;=3
   Text
         In Access-Requests, the RADIUS client takes the value of the
         realm directive (realm-value according to [RFC2617]) without
         surrounding quotes from the HTTP-style request it wants to
         authenticate.  In <A HREF="rfc2865.html#Access-Challenge">Access-Challenge</A> packets, the RADIUS server
         puts the expected realm value into this attribute.

<A NAME="Digest-Nonce"><H2>3.3.  Digest-Nonce Attribute</H2></a>

<B>   Description</B>

         This attribute holds a nonce to be used in the HTTP Digest
         calculation.  If the <A HREF="rfc2865.html#Access-Request">Access-Request</A> had a <A HREF="#Digest-Method">Digest-Method</A> and a
         <A HREF="#Digest-URI">Digest-URI</A> but no <B>Digest-Nonce</B> attribute, the RADIUS server
         MUST put a <B>Digest-Nonce</B> attribute into its <A HREF="rfc2865.html#Access-Challenge">Access-Challenge</A>
         packet.  This attribute MUST only be used in <A HREF="rfc2865.html#Access-Request">Access-Request</A> and
         <A HREF="rfc2865.html#Access-Challenge">Access-Challenge</A> packets.
<B>   Type</B>
         105 for <B>Digest-Nonce</B>
<B>   Length</B>
         &gt;=3
   Text
         In Access-Requests, the RADIUS client takes the value of the
         nonce directive (nonce-value in [RFC2617]) without surrounding
         quotes from the HTTP-style request it wants to authenticate.
         In <A HREF="rfc2865.html#Access-Challenge">Access-Challenge</A> packets, the attribute contains the nonce
         selected by the RADIUS server.




Sterman, et al.             Standards Track                    [Page 13]

RFC 4590              RADIUS Digest Authentication             July 2006


<A NAME="Digest-Response-Auth"><H2>3.4.  Digest-Response-Auth Attribute</H2></a>

<B>   Description</B>
         This attribute enables the RADIUS server to prove possession of
         the password.  If the previously received <A HREF="#Digest-Qop">Digest-Qop</A> attribute
         was 'auth-int' (without surrounding quotes), the RADIUS server
         MUST send a Digest-HA1 attribute instead of a
         <B>Digest-Response-Auth</B> attribute.  The <B>Digest-Response-Auth</B>
         attribute MUST only be used in <A HREF="rfc2865.html#Access-Accept">Access-Accept</A> packets.  The
         RADIUS client puts the attribute value without surrounding
         quotes into the rspauth directive of the Authentication-Info
         header.
<B>   Type</B>
         106 for <B>Digest-Response-Auth</B>.
<B>   Length</B>
         &gt;= 3
   Text
         The RADIUS server calculates a digest according to section
         3.2.3 of [RFC2617] and copies the result into this attribute.
         Digest algorithms other than the one defined in [RFC2617] MAY
         define digest lengths other than 32.

<A NAME="Digest-Nextnonce"><H2>3.5.  Digest-Nextnonce Attribute</H2></a>

   This attribute holds a nonce to be used in the HTTP Digest
   calculation.

<B>   Description</B>

         The RADIUS server MAY put a <B>Digest-Nextnonce</B> attribute into an
         <A HREF="rfc2865.html#Access-Accept">Access-Accept</A> packet.  If this attribute is present, the RADIUS
         client MUST put the contents of this attribute into the
         nextnonce directive of an Authentication-Info header in its
         HTTP-style response.  This attribute MUST only be used in
         <A HREF="rfc2865.html#Access-Accept">Access-Accept</A> packets.
<B>   Type</B>
         107 for <B>Digest-Nextnonce</B>
<B>   Length</B>
         &gt;=3
   Text
         It is recommended that this text be base64 or hexadecimal data.

<A NAME="Digest-Method"><H2>3.6.  Digest-Method Attribute</H2></a>

<B>   Description</B>
         This attribute holds the method value to be used in the HTTP
         Digest calculation.  This attribute MUST only be used in
         <A HREF="rfc2865.html#Access-Request">Access-Request</A> packets.



Sterman, et al.             Standards Track                    [Page 14]

RFC 4590              RADIUS Digest Authentication             July 2006


<B>   Type</B>
         108 for <B>Digest-Method</B>
<B>   Length</B>
         &gt;=3
   Text
         In Access-Requests, the RADIUS client takes the value of the
         request method from the HTTP-style request it wants to
         authenticate.

<A NAME="Digest-URI"><H2>3.7.  Digest-URI Attribute</H2></a>

<B>   Description</B>
         This attribute is used to transport the contents of the
         digest-uri directive or the URI of the HTTP-style request.  It
         MUST only be used in <A HREF="rfc2865.html#Access-Request">Access-Request</A> packets.
<B>   Type</B>
         109 for <B>Digest-URI</B>
<B>   Length</B>
         &gt;=3
   Text
         If the HTTP-style request has an Authorization header, the
         RADIUS client puts the value of the "uri" directive found in
         the HTTP-style request Authorization header (known as
         "digest-uri-value" in section 3.2.2 of [RFC2617]) without
         surrounding quotes into this attribute.  If there is no
         Authorization header, the RADIUS client takes the value of the
         request URI from the HTTP-style request it wants to
         authenticate.

<A NAME="Digest-Qop"><H2>3.8.  Digest-Qop Attribute</H2></a>

<B>   Description</B>
         This attribute holds the Quality of Protection parameter that
         influences the HTTP Digest calculation.  This attribute MUST
         only be used in <A HREF="rfc2865.html#Access-Request">Access-Request</A> and <A HREF="rfc2865.html#Access-Challenge">Access-Challenge</A> packets.  A
         RADIUS client SHOULD insert one of the <B>Digest-Qop</B> attributes it
         has received in a previous <A HREF="rfc2865.html#Access-Challenge">Access-Challenge</A> packet.  RADIUS
         servers SHOULD insert at least one <B>Digest-Qop</B> attribute in an
         <A HREF="rfc2865.html#Access-Challenge">Access-Challenge</A> packet.  <B>Digest-Qop</B> is optional in order to
         preserve backward compatibility with a minimal implementation
         of [RFC2069].
<B>   Type</B>
         110 for <B>Digest-Qop</B>
<B>   Length</B>
         &gt;=3
   Text
         In Access-Requests, the RADIUS client takes the value of the
         qop directive (qop-value as described in [RFC2617]) from the



Sterman, et al.             Standards Track                    [Page 15]

RFC 4590              RADIUS Digest Authentication             July 2006


         HTTP-style request it wants to authenticate.  In
         <A HREF="rfc2865.html#Access-Challenge">Access-Challenge</A> packets, the RADIUS server puts a desired
         qop-value into this attribute.  If the RADIUS server supports
         more than one "quality of protection" value, it puts each
         qop-value into a separate <B>Digest-Qop</B> attribute.

<A NAME="Digest-Algorithm"><H2>3.9.  Digest-Algorithm Attribute</H2></a>

<B>   Description</B>
         This attribute holds the algorithm parameter that influences
         the HTTP Digest calculation.  It MUST only be used in
         <A HREF="rfc2865.html#Access-Request">Access-Request</A> and <A HREF="rfc2865.html#Access-Challenge">Access-Challenge</A> packets.  If this attribute
         is missing, MD5 is assumed.
<B>   Type</B>
         111 for <B>Digest-Algorithm</B>
<B>   Length</B>
         &gt;=3
   Text
         In Access-Requests, the RADIUS client takes the value of the
         algorithm directive (as described in [RFC2617], section 3.2.1)
         from the HTTP-style request it wants to authenticate.  In
         <A HREF="rfc2865.html#Access-Challenge">Access-Challenge</A> packets, the RADIUS server SHOULD put the
         desired algorithm into this attribute.

<A NAME="Digest-Entity-Body-Hash"><H2>3.10.  Digest-Entity-Body-Hash Attribute</H2></a>

<B>   Description</B>
         When using the qop-level 'auth-int', a hash of the HTTP-style
         message body's contents is required for digest calculation.
         Instead of sending the complete body of the message, only its
         hash value is sent.  This hash value can be used directly in
         the digest calculation.

         The clarifications described in section 22.4 of [RFC3261] about
         the hash of empty entity bodies apply to the
         <B>Digest-Entity-Body-Hash</B> attribute.  This attribute MUST only be
         sent in <A HREF="rfc2865.html#Access-Request">Access-Request</A> packets.
<B>   Type</B>
         112 for <B>Digest-Entity-Body-Hash</B>
<B>   Length</B>
         &gt;=3
   Text
         The attribute holds the hexadecimal representation of
         H(entity-body).  This hash is required by certain
         authentication mechanisms, such as HTTP Digest with quality of
         protection set to "auth-int".  RADIUS clients MUST use this
         attribute to transport the hash of the entity body when HTTP
         Digest is the authentication mechanism and the RADIUS server



Sterman, et al.             Standards Track                    [Page 16]

RFC 4590              RADIUS Digest Authentication             July 2006


         requires that the integrity of the entity body (e.g., qop
         parameter set to "auth-int") be verified.  Extensions to this
         document may define support for authentication mechanisms other
         than HTTP Digest.

<A NAME="Digest-CNonce"><H2>3.11.  Digest-CNonce Attribute</H2></a>

<B>   Description</B>
         This attribute holds the client nonce parameter that is used in
         the HTTP Digest calculation.  It MUST only be used in
         <A HREF="rfc2865.html#Access-Request">Access-Request</A> packets.
<B>   Type</B>
         113 for <B>Digest-CNonce</B>
<B>   Length</B>
         &gt;=3
   Text
         This attribute includes the value of the cnonce-value [RFC2617]
         without surrounding quotes, taken from the HTTP-style request.

<A NAME="Digest-Nonce-Count"><H2>3.12.  Digest-Nonce-Count Attribute</H2></a>

<B>   Description</B>
         This attribute includes the nonce count parameter that is used
         to detect replay attacks.  The attribute MUST only be used in
         <A HREF="rfc2865.html#Access-Request">Access-Request</A> packets.

<B>   Type</B>
         114 for <B>Digest-Nonce-Count</B>
<B>   Length</B>
         10
   Text
         In Access-Requests, the RADIUS client takes the value of the nc
         directive (nc-value according to [RFC2617]) without surrounding
         quotes from the HTTP-style request it wants to authenticate.

<A NAME="Digest-Username"><H2>3.13.  Digest-Username Attribute</H2></a>

<B>   Description</B>
         This attribute holds the user name used in the HTTP Digest
         calculation.  The RADIUS server MUST use this attribute only
         for the purposes of calculating the digest.  In order to
         determine the appropriate user credentials, the RADIUS server
         MUST use the <A HREF="rfc2865.html#User-Name">User-Name</A> (1) attribute, and MUST NOT use the
         <B>Digest-Username</B> attribute.  This attribute MUST only be used in
         <A HREF="rfc2865.html#Access-Request">Access-Request</A> packets.
<B>   Type</B>
         115 for <B>Digest-Username</B>




Sterman, et al.             Standards Track                    [Page 17]

RFC 4590              RADIUS Digest Authentication             July 2006


<B>   Length</B>
         &gt;= 3
   Text
         In Access-Requests, the RADIUS client takes the value of the
         username directive (username-value according to [RFC2617])
         without surrounding quotes from the HTTP-style request it wants
         to authenticate.

<A NAME="Digest-Opaque"><H2>3.14.  Digest-Opaque Attribute</H2></a>

<B>   Description</B>
         This attribute holds the opaque parameter that is passed to the
         HTTP-style client.  The HTTP-style client will pass this value
         back to the server (i.e., the RADIUS client) without
         modification.  This attribute MUST only be used in
         <A HREF="rfc2865.html#Access-Request">Access-Request</A> and <A HREF="rfc2865.html#Access-Challenge">Access-Challenge</A> packets.
<B>   Type</B>
         116 for <B>Digest-Opaque</B>
<B>   Length</B>
         &gt;=3
   Text
         In Access-Requests, the RADIUS client takes the value of the
         opaque directive (opaque-value according to [RFC2617]) without
         surrounding quotes from the HTTP-style request it wants to
         authenticate and puts it into this attribute.  In
         <A HREF="rfc2865.html#Access-Challenge">Access-Challenge</A> packets, the RADIUS server MAY include this
         attribute.

<A NAME="Digest-Auth-Param"><H2>3.15.  Digest-Auth-Param Attribute</H2></a>

<B>   Description</B>
         This attribute is a placeholder for future extensions and
         corresponds to the "auth-param" parameter defined in section
         3.2.1 of [RFC2617].  The <B>Digest-Auth-Param</B> is the mechanism
         whereby the RADIUS client and RADIUS server can exchange
         auth-param extension parameters contained within Digest headers
         that are not understood by the RADIUS client and for which
         there are no corresponding stand-alone attributes.

         Unlike the previously listed Digest-* attributes, the
         <B>Digest-Auth-Param</B> contains not only the value but also the
         parameter name, since the parameter name is unknown to the
         RADIUS client.  If the Digest header contains several unknown
         parameters, then the RADIUS implementation MUST repeat this
         attribute and each instance MUST contain one different unknown
         Digest parameter/value combination.  This attribute MUST ONLY
         be used in <A HREF="rfc2865.html#Access-Request">Access-Request</A>, <A HREF="rfc2865.html#Access-Challenge">Access-Challenge</A>, or <A HREF="rfc2865.html#Access-Accept">Access-Accept</A>
         packets.



Sterman, et al.             Standards Track                    [Page 18]

RFC 4590              RADIUS Digest Authentication             July 2006


<B>   Type</B>
         117 for <B>Digest-Auth-Param</B>
<B>   Length</B>
         &gt;=3
   Text
         The text consists of the whole parameter, including its name
         and the equal sign ('=') and quotes.

<A NAME="Digest-AKA-Auts"><H2>3.16.  Digest-AKA-Auts Attribute</H2></a>

<B>   Description</B>
         This attribute holds the auts parameter that is used in the
         Digest AKA ([RFC3310]) calculation.  It is only used if the
         algorithm of the digest-response denotes a version of AKA
         Digest [RFC3310].  This attribute MUST only be used in
         <A HREF="rfc2865.html#Access-Request">Access-Request</A> packets.
<B>   Type</B>
         118 for <B>Digest-AKA-Auts</B>
<B>   Length</B>
         &gt;=3
   Text
         In Access-Requests, the RADIUS client takes the value of the
         auts directive (auts-param according to section 3.4 of
         [RFC3310]) without surrounding quotes from the HTTP-style
         request it wants to authenticate.

<A NAME="Digest-Domain"><H2>3.17.  Digest-Domain Attribute</H2></a>

<B>   Description</B>
         When a RADIUS client has asked for a nonce, the RADIUS server
         MAY send one or more <B>Digest-Domain</B> attributes in its
         <A HREF="rfc2865.html#Access-Challenge">Access-Challenge</A> packet.  The RADIUS client puts them into the
         quoted, space-separated list of URIs of the 'domain' directive
         of a WWW-Authenticate header.  Together with <A HREF="#Digest-Realm">Digest-Realm</A>, the
         URIs in the list define the protection space (see [RFC2617],
         section 3.2.1) for some HTTP-style protocols.  This attribute
         MUST only be used in <A HREF="rfc2865.html#Access-Challenge">Access-Challenge</A> packets.
<B>   Type</B>
         119 for <B>Digest-Domain</B>
<B>   Length</B>
         3
   Text
         This attribute consists of a single URI that defines a
         protection space component.







Sterman, et al.             Standards Track                    [Page 19]

RFC 4590              RADIUS Digest Authentication             July 2006


<A NAME="Digest-Stale"><H2>3.18.  Digest-Stale Attribute</H2></a>

<B>   Description</B>
         This attribute is sent by a RADIUS server in order to notify
         the RADIUS client whether it has accepted a nonce.  If the
         nonce presented by the RADIUS client was stale, the value is
         'true' and is 'false' otherwise.  The RADIUS client puts the
         content of this attribute into a 'stale' directive of the
         WWW-Authenticate header in the HTTP-style response to the
         request it wants to authenticate.  The attribute MUST only be
         used in <A HREF="rfc2865.html#Access-Challenge">Access-Challenge</A> packets.
<B>   Type</B>
         120 for <B>Digest-Stale</B>
<B>   Length</B>
         3
   Text
         The attribute has either the value 'true' or 'false' (both
         values without surrounding quotes).

<A NAME="Digest-HA1"><H2>3.19.  Digest-HA1 Attribute</H2></a>

<B>   Description</B>
         This attribute is used to allow the generation of an
         Authentication-Info header, even if the HTTP-style response's
         body is required for the calculation of the rspauth value.  It
         SHOULD be used in <A HREF="rfc2865.html#Access-Accept">Access-Accept</A> packets if the required quality
         of protection ('qop') is 'auth-int'.

         This attribute MUST NOT be sent if the qop parameter was not
         specified or has a value of 'auth' (in this case, use
         <A HREF="#Digest-Response-Auth">Digest-Response-Auth</A> instead).

         The <B>Digest-HA1</B> attribute MUST only be sent by the RADIUS server
         or processed by the RADIUS client if at least one of the
         following conditions is true:

         +  The <A HREF="#Digest-Algorithm">Digest-Algorithm</A> attribute's value is 'MD5-sess' or
            'AKAv1-MD5-sess'.

         +  IPsec is configured to protect traffic between RADIUS client
            and RADIUS server with IPsec (see Section 8).

         This attribute MUST only be used in <A HREF="rfc2865.html#Access-Accept">Access-Accept</A> packets.
<B>   Type</B>
         121 for <B>Digest-HA1</B>
<B>   Length</B>
         &gt;= 3




Sterman, et al.             Standards Track                    [Page 20]

RFC 4590              RADIUS Digest Authentication             July 2006


   Text
         This attribute contains the hexadecimal representation of H(A1)
         as described in [RFC2617], sections 3.1.3, 3.2.1, and 3.2.2.2.

<A NAME="SIP-AOR"><H2>3.20.  SIP-AOR Attribute</H2></a>

<B>   Description</B>
         This attribute is used for the authorization of SIP messages.
         The <B>SIP-AOR</B> attribute identifies the URI, the use of which must
         be authenticated and authorized.  The RADIUS server uses this
         attribute to authorize the processing of the SIP request.  The
         <B>SIP-AOR</B> can be derived from, for example, the To header field
         in a SIP REGISTER request (user under registration), or the
         From header field in other SIP requests.  However, the exact
         mapping of this attribute to SIP can change due to new
         developments in the protocol.  This attribute MUST only be used
         when the RADIUS client wants to authorize SIP users and MUST
         only be used in <A HREF="rfc2865.html#Access-Request">Access-Request</A> packets.
<B>   Type</B>
         122 for <B>SIP-AOR</B>
<B>   Length</B>
         &gt;=3
   Text
         The syntax of this attribute corresponds either to a SIP URI
         (with the format defined in [RFC3261] or a tel URI (with the
         format defined in [RFC3966]).

         The <B>SIP-AOR</B> attribute holds the complete URI, including
         parameters and other parts.  It is up to the RADIUS server what
         components of the URI are regarded in the authorization
         decision.

<H2>4.  Diameter Compatibility</H2>

   This document defines support for Digest Authentication in RADIUS.  A
   companion document "Diameter Session Initiation Protocol (SIP)
   Application" [SIP-APP] defines support for Digest Authentication in
   Diameter, and addresses compatibility issues between RADIUS and
   Diameter.












Sterman, et al.             Standards Track                    [Page 21]

RFC 4590              RADIUS Digest Authentication             July 2006


<H2>5.  Table of Attributes</H2>

   The following table provides a guide to which attributes may be found
   in which kinds of packets, and in what quantity.

   +-----+--------+--------+-----------+-----+-------------------------+
   | Req | Accept | Reject | Challenge | #   | Attribute               |
   +-----+--------+--------+-----------+-----+-------------------------+
   | 1   | 0      | 0      | 0         | 1   | <A HREF="rfc2865.html#User-Name">User-Name</A>               |
   | 1   | 1      | 1      | 1         | 80  | <A HREF="rfc2869.html#Message-Authenticator">Message-Authenticator</A>   |
   | 0-1 | 0      | 0      | 0         | 103 | <A HREF="#Digest-Response">Digest-Response</A>         |
   | 0-1 | 0      | 0      | 1         | 104 | <A HREF="#Digest-Realm">Digest-Realm</A>            |
   | 0-1 | 0      | 0      | 1         | 105 | <A HREF="#Digest-Nonce">Digest-Nonce</A>            |
   | 0   | 0-1    | 0      | 0         | 106 | <A HREF="#Digest-Response-Auth">Digest-Response-Auth</A>    |
   |     |        |        |           |     | (see Note 1, 2)         |
   | 0   | 0-1    | 0      | 0         | 107 | <A HREF="#Digest-Nextnonce">Digest-Nextnonce</A>        |
   | 0-1 | 0      | 0      | 0         | 108 | <A HREF="#Digest-Method">Digest-Method</A>           |
   | 0-1 | 0      | 0      | 0         | 109 | <A HREF="#Digest-URI">Digest-URI</A>              |
   | 0-1 | 0      | 0      | 0+        | 110 | <A HREF="#Digest-Qop">Digest-Qop</A>              |
   | 0-1 | 0      | 0      | 0-1       | 111 | <A HREF="#Digest-Algorithm">Digest-Algorithm</A> (see   |
   |     |        |        |           |     | Note 3)                 |
   | 0-1 | 0      | 0      | 0         | 112 | <A HREF="#Digest-Entity-Body-Hash">Digest-Entity-Body-Hash</A> |
   | 0-1 | 0      | 0      | 0         | 113 | <A HREF="#Digest-CNonce">Digest-CNonce</A>           |
   | 0-1 | 0      | 0      | 0         | 114 | <A HREF="#Digest-Nonce-Count">Digest-Nonce-Count</A>      |
   | 0-1 | 0      | 0      | 0         | 115 | <A HREF="#Digest-Username">Digest-Username</A>         |
   | 0-1 | 0      | 0      | 0-1       | 116 | <A HREF="#Digest-Opaque">Digest-Opaque</A>           |
   | 0+  | 0+     | 0      | 0+        | 117 | <A HREF="#Digest-Auth-Param">Digest-Auth-Param</A>       |
   | 0-1 | 0      | 0      | 0         | 118 | <A HREF="#Digest-AKA-Auts">Digest-AKA-Auts</A>         |
   | 0   | 0      | 0      | 0+        | 119 | <A HREF="#Digest-Domain">Digest-Domain</A>           |
   | 0   | 0      | 0      | 0-1       | 120 | <A HREF="#Digest-Stale">Digest-Stale</A>            |
   | 0   | 0-1    | 0      | 0         | 121 | Digest-HA1 (see Note 1, |
   |     |        |        |           |     | 2)                      |
   | 0-1 | 0      | 0      | 0         | 122 | <A HREF="#SIP-AOR">SIP-AOR</A>                 |
   +-----+--------+--------+-----------+-----+-------------------------+

                                  Table 1

   [Note 1] Digest-HA1 MUST be used instead of <A HREF="#Digest-Response-Auth">Digest-Response-Auth</A> if
      <A HREF="#Digest-Qop">Digest-Qop</A> is 'auth-int'.

   [Note 2] <A HREF="#Digest-Response-Auth">Digest-Response-Auth</A> MUST be used instead of Digest-HA1 if
      <A HREF="#Digest-Qop">Digest-Qop</A> is 'auth'.

   [Note 3] If <A HREF="#Digest-Algorithm">Digest-Algorithm</A> is missing, 'MD5' is assumed.







Sterman, et al.             Standards Track                    [Page 22]

RFC 4590              RADIUS Digest Authentication             July 2006


<H2>6.  Examples</H2>

   This is an example selected from the traffic between a softphone (A),
   a Proxy Server (B), and an example.com RADIUS server (C).  The
   communication between the Proxy Server and a SIP Public Switched
   Telephone Network (PSTN) gateway is omitted for brevity.  The SIP
   messages are not shown completely.

   A-&gt;B

      INVITE sip:97226491335@example.com SIP/2.0
      From: &lt;sip:12345678@example.com&gt;
      To: &lt;sip:97226491335@example.com&gt;

   B-&gt;A

      SIP/2.0 100 Trying

   B-&gt;C

      Code = 1 (<A HREF="rfc2865.html#Access-Request">Access-Request</A>)
      Attributes:
      <A HREF="rfc2865.html#NAS-IP-Address">NAS-IP-Address</A> = c0 0 2 26 (192.0.2.38)
      <A HREF="rfc2865.html#NAS-Port-Type">NAS-Port-Type</A> = 5 (Virtual)
      <A HREF="rfc2865.html#User-Name">User-Name</A> = 12345678
      <A HREF="#Digest-Method">Digest-Method</A> = INVITE
      <A HREF="#Digest-URI">Digest-URI</A> = sip:97226491335@example.com
      <A HREF="rfc2869.html#Message-Authenticator">Message-Authenticator</A> =
       08 af 7e 01 b6 8d 74 c3 a4 3c 33 e1 56 2a 80 43

   C-&gt;B

      Code = 11 (<A HREF="rfc2865.html#Access-Challenge">Access-Challenge</A>)
      Attributes:
      <A HREF="#Digest-Nonce">Digest-Nonce</A> = 3bada1a0
      <A HREF="#Digest-Realm">Digest-Realm</A> = example.com
      <A HREF="#Digest-Qop">Digest-Qop</A> = auth
      <A HREF="#Digest-Algorithm">Digest-Algorithm</A> = MD5
      <A HREF="rfc2869.html#Message-Authenticator">Message-Authenticator</A> =
       f8 01 26 9f 70 5e ef 5d 24 ac f5 ca fb 27 da 40

   B-&gt;A

      SIP/2.0 407 Proxy Authentication Required
      Proxy-Authenticate: Digest realm="example.com"
           ,nonce="3bada1a0",qop=auth,algorithm=MD5
      Content-Length: 0




Sterman, et al.             Standards Track                    [Page 23]

RFC 4590              RADIUS Digest Authentication             July 2006


   A-&gt;B

      ACK sip:97226491335@example.com SIP/2.0

   A-&gt;B

      INVITE sip:97226491335@example.com SIP/2.0
      Proxy-Authorization: Digest algorithm="md5",nonce="3bada1a0"
           ,realm="example.com"
           ,response="f3ce87e6984557cd0fecc26f3c5e97a4"
           ,uri="sip:97226491335@example.com",username="12345678"
           ,qop=auth,algorithm=MD5
      From: &lt;sip:12345678@example.com&gt;
      To: &lt;sip:97226491335@example.com&gt;

   B-&gt;C

      Code = 1 (<A HREF="rfc2865.html#Access-Request">Access-Request</A>)
      Attributes:
      <A HREF="rfc2865.html#NAS-IP-Address">NAS-IP-Address</A> = c0 0 2 26 (192.0.2.38)
      <A HREF="rfc2865.html#NAS-Port-Type">NAS-Port-Type</A> = 5 (Virtual)
      <A HREF="rfc2865.html#User-Name">User-Name</A> = 12345678
      <A HREF="#Digest-Response">Digest-Response</A> = f3ce87e6984557cd0fecc26f3c5e97a4
      <A HREF="#Digest-Realm">Digest-Realm</A> = example.com
      <A HREF="#Digest-Nonce">Digest-Nonce</A> = 3bada1a0
      <A HREF="#Digest-Method">Digest-Method</A> = INVITE
      <A HREF="#Digest-URI">Digest-URI</A> = sip:97226491335@example.com
      <A HREF="#Digest-Qop">Digest-Qop</A> = auth
      <A HREF="#Digest-Algorithm">Digest-Algorithm</A> = md5
      <A HREF="#Digest-Username">Digest-Username</A> =  12345678
      <A HREF="#SIP-AOR">SIP-AOR</A> =  sip:12345678@example.com
      <A HREF="rfc2869.html#Message-Authenticator">Message-Authenticator</A> =
          ff 67 f4 13 8e b8 59 32 22 f9 37 0f 32 f8 e0 ff

   C-&gt;B

      Code = 2 (<A HREF="rfc2865.html#Access-Accept">Access-Accept</A>)
      Attributes:
      <A HREF="#Digest-Response-Auth">Digest-Response-Auth</A> =
                      6303c41b0e2c3e524e413cafe8cce954
      <A HREF="rfc2869.html#Message-Authenticator">Message-Authenticator</A> =
          75 8d 44 49 66 1f 7b 47 9d 10 d0 2d 4a 2e aa f1

   B-&gt;A

      SIP/2.0 180 Ringing





Sterman, et al.             Standards Track                    [Page 24]

RFC 4590              RADIUS Digest Authentication             July 2006


   B-&gt;A

      SIP/2.0 200 OK

   A-&gt;B

      ACK sip:97226491335@example.com SIP/2.0

   A second example shows the traffic between a web browser (A), web
   server (B), and a RADIUS server (C).

   A-&gt;B

      GET /index.html HTTP/1.1

   B-&gt;C

      Code = 1 (<A HREF="rfc2865.html#Access-Request">Access-Request</A>)
      Attributes:
      <A HREF="rfc2865.html#NAS-IP-Address">NAS-IP-Address</A> = c0 0 2 26 (192.0.2.38)
      <A HREF="rfc2865.html#NAS-Port-Type">NAS-Port-Type</A> = 5 (Virtual)
      <A HREF="#Digest-Method">Digest-Method</A> = GET
      <A HREF="#Digest-URI">Digest-URI</A> = /index.html
      <A HREF="rfc2869.html#Message-Authenticator">Message-Authenticator</A> =
       34 a6 26 46 f3 81 f9 b4 97 c0 dd 9d 11 8f ca c7

   C-&gt;B

      Code = 11 (<A HREF="rfc2865.html#Access-Challenge">Access-Challenge</A>)
      Attributes:
      <A HREF="#Digest-Nonce">Digest-Nonce</A> = a3086ac8
      <A HREF="#Digest-Realm">Digest-Realm</A> = example.com
      <A HREF="#Digest-Qop">Digest-Qop</A> = auth
      <A HREF="#Digest-Algorithm">Digest-Algorithm</A> = MD5
      <A HREF="rfc2869.html#Message-Authenticator">Message-Authenticator</A> =
       f8 01 26 9f 70 5e ef 5d 24 ac f5 ca fb 27 da 40

   B-&gt;A

      HTTP/1.1 401 Authentication Required
      WWW-Authenticate: Digest realm="example.com",
          nonce="a3086ac8",qop=auth,algorithm=MD5
      Content-Length: 0








Sterman, et al.             Standards Track                    [Page 25]

RFC 4590              RADIUS Digest Authentication             July 2006


   A-&gt;B

      GET /index.html HTTP/1.1
      Authorization: Digest algorithm=MD5,nonce="a3086ac8"
           ,realm="example.com"
           ,response="f052b68058b2987aba493857ae1ab002"
           ,uri="/index.html",username="12345678"
           ,qop=auth,algorithm=MD5

   B-&gt;C

      Code = 1 (<A HREF="rfc2865.html#Access-Request">Access-Request</A>)
      Attributes:
      <A HREF="rfc2865.html#NAS-IP-Address">NAS-IP-Address</A> = c0 0 2 26 (192.0.2.38)
      <A HREF="rfc2865.html#NAS-Port-Type">NAS-Port-Type</A> = 5 (Virtual)
      <A HREF="rfc2865.html#User-Name">User-Name</A> = 12345678
      <A HREF="#Digest-Response">Digest-Response</A> = f052b68058b2987aba493857ae1ab002
      <A HREF="#Digest-Realm">Digest-Realm</A> = example.com
      <A HREF="#Digest-Nonce">Digest-Nonce</A> = a3086ac8
      <A HREF="#Digest-Method">Digest-Method</A> = GET
      <A HREF="#Digest-URI">Digest-URI</A> = /index.html
      <A HREF="#Digest-Username">Digest-Username</A> =  12345678
      <A HREF="#Digest-Qop">Digest-Qop</A> = auth
      <A HREF="#Digest-Algorithm">Digest-Algorithm</A> = MD5
      <A HREF="rfc2869.html#Message-Authenticator">Message-Authenticator</A> =
          06 e1 65 23 57 94 e6 de 87 5a e8 ce a2 7d 43 6b

   C-&gt;B

      Code = 2 (<A HREF="rfc2865.html#Access-Accept">Access-Accept</A>)
      Attributes:
      <A HREF="#Digest-Response-Auth">Digest-Response-Auth</A> =
          e644aa513effbfe1caff67103ff6433c
      <A HREF="rfc2869.html#Message-Authenticator">Message-Authenticator</A> =
          7a 66 73 a3 52 44 dd ca 90 e2 f6 10 61 2d 81 d7

   B-&gt;A

      HTTP/1.1 200 OK
      ...

      &lt;html&gt;
      ...








Sterman, et al.             Standards Track                    [Page 26]

RFC 4590              RADIUS Digest Authentication             July 2006


<H2>7.  IANA Considerations</H2>

   This document serves as an IANA registration request for a number of
   values from the RADIUS attribute type number space.  The IANA has
   assigned the following:

           +-------------------------+------------------------+
           | placeholder             | value assigned by IANA |
           +-------------------------+------------------------+
           | <A HREF="#Digest-Response">Digest-Response</A>         | 103                    |
           | <A HREF="#Digest-Realm">Digest-Realm</A>            | 104                    |
           | <A HREF="#Digest-Nonce">Digest-Nonce</A>            | 105                    |
           | <A HREF="#Digest-Nextnonce">Digest-Nextnonce</A>        | 106                    |
           | <A HREF="#Digest-Response-Auth">Digest-Response-Auth</A>    | 107                    |
           | <A HREF="#Digest-Method">Digest-Method</A>           | 108                    |
           | <A HREF="#Digest-URI">Digest-URI</A>              | 109                    |
           | <A HREF="#Digest-Qop">Digest-Qop</A>              | 110                    |
           | <A HREF="#Digest-Algorithm">Digest-Algorithm</A>        | 111                    |
           | <A HREF="#Digest-Entity-Body-Hash">Digest-Entity-Body-Hash</A> | 112                    |
           | <A HREF="#Digest-CNonce">Digest-CNonce</A>           | 113                    |
           | <A HREF="#Digest-Nonce-Count">Digest-Nonce-Count</A>      | 114                    |
           | <A HREF="#Digest-Username">Digest-Username</A>         | 115                    |
           | <A HREF="#Digest-Opaque">Digest-Opaque</A>           | 116                    |
           | <A HREF="#Digest-Auth-Param">Digest-Auth-Param</A>       | 117                    |
           | <A HREF="#Digest-AKA-Auts">Digest-AKA-Auts</A>         | 118                    |
           | <A HREF="#Digest-Domain">Digest-Domain</A>           | 119                    |
           | <A HREF="#Digest-Stale">Digest-Stale</A>            | 120                    |
           | Digest-HA1              | 121                    |
           | <A HREF="#SIP-AOR">SIP-AOR</A>                 | 122                    |
           +-------------------------+------------------------+

                                  Table 2

<H2>8.  Security Considerations</H2>

   The RADIUS extensions described in this document enable RADIUS to
   transport the data that is required to perform a digest calculation.
   As a result, RADIUS inherits the vulnerabilities of HTTP Digest (see
   [RFC2617], section 4) in addition to RADIUS security vulnerabilities
   described in [RFC2865], section 8, and [RFC3579], section 4.

   An attacker compromising a RADIUS client or proxy can carry out
   man-in-the-middle attacks even if the paths between A, B and B, C
   (Figure 2) have been secured with TLS or IPsec.

   The RADIUS server MUST check the <A HREF="#Digest-Realm">Digest-Realm</A> attribute it has
   received from a client.  If the RADIUS client is not authorized to
   serve HTTP-style clients of that realm, it might be compromised.



Sterman, et al.             Standards Track                    [Page 27]

RFC 4590              RADIUS Digest Authentication             July 2006


<H2>8.1.  Denial of Service</H2>

   RADIUS clients implementing the extension described in this document
   may authenticate HTTP-style requests received over the Internet.  As
   compared with the use of RADIUS to authenticate link-layer network
   access, attackers may find it easier to cover their tracks in such a
   scenario.

   An attacker can attempt a denial-of-service attack on one or more
   RADIUS servers by sending a large number of HTTP-style requests.  To
   make simple denial-of-service attacks more difficult, the RADIUS
   server MUST check whether it has generated the nonce received from an
   HTTP-style client.  This SHOULD be done statelessly.  For example, a
   nonce could consist of a cryptographically random part and some kind
   of signature provided by the RADIUS client, as described in
   [RFC2617], section 3.2.1.

<H2>8.2.  Confidentiality and Data Integrity</H2>

   The attributes described in this document are sent in cleartext.
   RADIUS servers SHOULD include <A HREF="#Digest-Qop">Digest-Qop</A> and <A HREF="#Digest-Algorithm">Digest-Algorithm</A>
   attributes in <A HREF="rfc2865.html#Access-Challenge">Access-Challenge</A> messages.  A man in the middle can
   modify or remove those attributes in a bidding down attack, causing
   the RADIUS client to use a weaker authentication scheme than
   intended.

   The <A HREF="rfc2869.html#Message-Authenticator">Message-Authenticator</A> attribute, described in [RFC3579], section
   3.2 MUST be included in <A HREF="rfc2865.html#Access-Request">Access-Request</A>, <A HREF="rfc2865.html#Access-Challenge">Access-Challenge</A>,
   <A HREF="rfc2865.html#Access-Reject">Access-Reject</A>, and <A HREF="rfc2865.html#Access-Accept">Access-Accept</A> messages that contain attributes
   described in this specification.

   The Digest-HA1 attribute contains no random components if the
   algorithm is 'MD5' or 'AKAv1-MD5'.  This makes offline dictionary
   attacks easier and enables replay attacks.

   Some parameter combinations require the protection of RADIUS packets
   against eavesdropping and tampering.  Implementations SHOULD try to
   determine automatically whether IPsec is configured to protect
   traffic between the RADIUS client and the RADIUS server.  If this is
   not possible, the implementation checks a configuration parameter
   telling it whether IPsec will protect RADIUS traffic.  The default
   value of this configuration parameter tells the implementation that
   RADIUS packets will not be protected.

   HTTP-style clients can use TLS with server side certificates together
   with HTTP-Digest Authentication.  Instead of TLS, IPsec can be used,
   too.  TLS or IPsec secure the connection while Digest Authentication
   authenticates the user.  The RADIUS transaction can be regarded as



Sterman, et al.             Standards Track                    [Page 28]

RFC 4590              RADIUS Digest Authentication             July 2006


   one leg on the path between the HTTP-style client and the HTTP-style
   server.  To prevent RADIUS from representing the weak link, a RADIUS
   client receiving an HTTP-style request via TLS or IPsec could use an
   equally secure connection to the RADIUS server.  There are several
   ways to achieve this, for example:

   o  The RADIUS client may reject HTTP-style requests received over TLS
      or IPsec.

   o  The RADIUS client may require that traffic be sent and received
      over IPsec.

   RADIUS over IPsec, if used, MUST conform to the requirements
   described in [RFC3579], section 4.2.

<H2>9.  Acknowledgements</H2>

   We would like to acknowledge Kevin McDermott (Cisco Systems) for
   providing comments and experimental implementation.

   Many thanks to all reviewers, especially to Miguel Garcia, Jari
   Arkko, Avi Lior, and Jun Wang.

<H2>10.  References</H2>

<H2>10.1.  Normative References</H2>

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119, March 1997.

   [RFC2617]  Franks, J., Hallam-Baker, P., Hostetler, J., Lawrence, S.,
              Leach, P., Luotonen, A., and L. Stewart, "HTTP
              Authentication: Basic and Digest Access Authentication",
              RFC 2617, June 1999.

   [RFC2865]  Rigney, C., Willens, S., Rubens, A., and W. Simpson,
              "Remote Authentication Dial In User Service (RADIUS)", RFC
              2865, June 2000.

   [RFC3261]  Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston,
              A., Peterson, J., Sparks, R., Handley, M., and E.
              Schooler, "SIP: Session Initiation Protocol", RFC 3261,
              June 2002.

   [RFC3579]  Aboba, B. and P. Calhoun, "RADIUS (Remote Authentication
              Dial In User Service) Support For Extensible
              Authentication Protocol (EAP)", RFC 3579, September 2003.




Sterman, et al.             Standards Track                    [Page 29]

RFC 4590              RADIUS Digest Authentication             July 2006


   [RFC3966]  Schulzrinne, H., "The tel URI for Telephone Numbers", RFC
              3966, December 2004.

<H2>10.2.  Informative References</H2>

   [SIP-APP]  Garcia-Martin, M., "Diameter Session Initiation Protocol
              (SIP) Application", Work in Progress), April 2006.

   [RFC1994]  Simpson, W., "PPP Challenge Handshake Authentication
              Protocol (CHAP)", RFC 1994, August 1996.

   [RFC2069]  Franks, J., Hallam-Baker, P., Hostetler, J., Leach, P.,
              Luotonen, A., Sink, E., and L. Stewart, "An Extension to
              HTTP : Digest Access Authentication", RFC 2069, January
              1997.

   [RFC4346]  Dierks, T. and E. Rescorla, "The Transport Layer Security
              (TLS) Protocol Version 1.1", RFC 4346, April 2006.

   [RFC3851]  Ramsdell, B., "Secure/Multipurpose Internet Mail
              Extensions (S/MIME) Version 3.1 Message Specification",
              RFC 3851, July 2004.

   [RFC3310]  Niemi, A., Arkko, J., and V. Torvinen, "Hypertext Transfer
              Protocol (HTTP) Digest Authentication Using Authentication
              and Key Agreement (AKA)", RFC 3310, September 2002.

   [RFC3588]  Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J.
              Arkko, "Diameter Base Protocol", RFC 3588, September 2003.






















Sterman, et al.             Standards Track                    [Page 30]

RFC 4590              RADIUS Digest Authentication             July 2006


Authors' Addresses

   Baruch Sterman
   Kayote Networks
   P.O. Box 1373
   Efrat  90435
   Israel

   EMail: baruch@kayote.com


   Daniel Sadolevsky
   SecureOL, Inc.
   Jerusalem Technology Park
   P.O. Box 16120
   Jerusalem  91160
   Israel

   EMail: dscreat@dscreat.com


   David Schwartz
   Kayote Networks
   P.O. Box 1373
   Efrat  90435
   Israel

   EMail: david@kayote.com


   David Williams
   Cisco Systems
   7025 Kit Creek Road
   P.O. Box 14987
   Research Triangle Park  NC 27709
   USA

   EMail: dwilli@cisco.com


   Wolfgang Beck
   Deutsche Telekom AG
   Deutsche Telekom Allee 7
   Darmstadt  64295
   Germany

   EMail: beckw@t-systems.com




Sterman, et al.             Standards Track                    [Page 31]

RFC 4590              RADIUS Digest Authentication             July 2006


Full Copyright Statement

   Copyright (C) The Internet Society (2006).

   This document is subject to the rights, licenses and restrictions
   contained in BCP 78, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET
   ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,
   INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE
   INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in BCP 78 and BCP 79.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   http://www.ietf.org/ipr.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.

Acknowledgement

   Funding for the RFC Editor function is provided by the IETF
   Administrative Support Activity (IASA).







Sterman, et al.             Standards Track                    [Page 32]

</PRE>
</BODY>
